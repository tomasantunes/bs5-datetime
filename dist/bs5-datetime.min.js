const DEFAULTS={format:"YYYY-MM-DD HH:mm",showTime:!0,showSeconds:!1,use24Hour:!0,startDay:1},LOCALES={"en-us":{monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],previousMonth:"Previous month",nextMonth:"Next month",time:"Time",applyDatetime:"Apply",hours:"Hours",minutes:"Minutes",weekDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},"pt-pt":{monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],previousMonth:"Mês anterior",nextMonth:"Mês seguinte",time:"Hora",applyDatetime:"Aplicar",hours:"Horas",minutes:"Minutos",weekDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"]}};function setDatetimeLocale(e){const t=LOCALES[e];t?Object.assign(window,t):console.warn(`Locale not found: ${e}`)}function pad(e,t=2){return String(e).padStart(t,"0")}function formatDate(e,t){const n=e.getFullYear(),a=pad(e.getMonth()+1),o=pad(e.getDate()),r=pad(e.getHours()),s=pad(e.getMinutes());return"YYYY-MM-DD HH:mm"===t.format?`${n}-${a}-${o} ${r}:${s}`:"YYYY-MM-DD"===t.format?`${n}-${a}-${o}`:"DD/MM/YYYY HH:mm"===t.format?`${o}/${a}/${n} ${r}:${s}`:"DD/MM/YYYY"===t.format?`${o}/${a}/${n}`:`${n}-${a}-${o} ${r}:${s}`}function parseInputToDate(e,t={}){if(!e)return null;const n=t.format||"YYYY-MM-DD HH:mm";let a,o,r,s,i=0,l=0;switch(n){case"YYYY-MM-DD HH:mm":a=/^(\d{4})-(\d{1,2})-(\d{1,2})[ T](\d{1,2}):(\d{1,2})$/;break;case"YYYY-MM-DD":a=/^(\d{4})-(\d{1,2})-(\d{1,2})$/;break;case"DD/MM/YYYY HH:mm":a=/^(\d{1,2})\/(\d{1,2})\/(\d{4})[ T]?(\d{1,2}):(\d{1,2})$/;break;case"DD/MM/YYYY":a=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;break;default:throw new Error(`Unsupported date format: ${n}`)}const d=e.match(a);if(!d)return null;n.startsWith("YYYY")?(o=Number(d[1]),r=Number(d[2])-1,s=Number(d[3]),d[4]&&(i=Number(d[4])),d[5]&&(l=Number(d[5]))):(s=Number(d[1]),r=Number(d[2])-1,o=Number(d[3]),d[4]&&(i=Number(d[4])),d[5]&&(l=Number(d[5])));const u=new Date(o,r,s,i,l,0,0);return isNaN(u.getTime())?null:u}function createTemplate(){if(document.getElementById("dtp-template"))return;const e=document.createElement("template");e.id="dtp-template",e.innerHTML=`\n      <div class="dtp-popup shadow rounded" role="dialog" aria-modal="false">\n          <div class="dtp-header d-flex justify-content-between align-items-center p-2 border-bottom">\n              <div class="dtp-month-year fs-6 fw-semibold"></div>\n              <div class="dtp-nav">\n              <button type="button" class="btn btn-sm dtp-prev" aria-label="${window.previousMonth}">‹</button>\n              <button type="button" class="btn btn-sm dtp-next" aria-label="${window.nextMonth}">›</button>\n              </div>\n          </div>\n\n          <div class="dtp-calendar p-2">\n              <div class="dtp-weekdays d-flex small text-muted"></div>\n              <div class="dtp-days d-flex flex-wrap"></div>\n          </div>\n\n          <div class="p-2 border-top d-flex">\n              <div class="dtp-time d-flex gap-2 align-items-center">\n                  <label class="mb-0 small">${window.time}</label>\n                  <input type="number" class="form-control form-control-sm dtp-hour" min="0" max="23" inputmode="numeric" aria-label="${window.hours}" style="width:4.5rem">\n                  <span>:</span>\n                  <input type="number" class="form-control form-control-sm dtp-minute" min="0" max="59" inputmode="numeric" aria-label="${window.minutes}" style="width:4.5rem">\n              </div>\n              <div class="ms-auto p-2">\n                  <button class="btn btn-sm btn-primary dtp-apply">${window.applyDatetime}</button>\n              </div>\n          </div>\n      </div>\n  `,document.body.appendChild(e)}function createDatetimePicker(e,t,n,a={}){const o=Object.assign({},DEFAULTS,a),r=document.getElementById("dtp-template");if(!r)throw new Error("Template not found");console.log("Options:",o);let s=null,i=null,l=null;function d(){s=r.content.firstElementChild.cloneNode(!0),document.body.appendChild(s),s.style.display="none",s._monthYear=s.querySelector(".dtp-month-year"),s._weekdays=s.querySelector(".dtp-weekdays"),s._days=s.querySelector(".dtp-days"),s._prev=s.querySelector(".dtp-prev"),s._next=s.querySelector(".dtp-next"),s._hour=s.querySelector(".dtp-hour"),s._minute=s.querySelector(".dtp-minute"),s._apply=s.querySelector(".dtp-apply"),s._prev.addEventListener("click",()=>{i.setMonth(i.getMonth()-1),u()}),s._next.addEventListener("click",()=>{i.setMonth(i.getMonth()+1),u()}),s._apply.addEventListener("click",g),s.addEventListener("keydown",t=>{"Escape"===t.key&&(w(),e.focus())}),setTimeout(()=>{window.addEventListener("click",b)},0),function(){const e=window.weekDays;s._weekdays.innerHTML="";for(let t=0;t<7;t++){const n=(o.startDay+t)%7,a=document.createElement("div");a.className="dtp-weekday flex-fill text-center",a.textContent=e[n],s._weekdays.appendChild(a)}}()}function u(){const e=window.monthNames,t=i.getMonth(),n=e[t],a=i.getFullYear();s._monthYear.textContent=`${n} ${a}`;let r=(new Date(a,t,1).getDay()-o.startDay+7)%7;const d=new Date(a,t,1-r);s._days.innerHTML="";for(let e=0;e<42;e++){const t=new Date(d.getFullYear(),d.getMonth(),d.getDate()+e),a=document.createElement("button");a.type="button",a.className="dtp-day btn btn-sm",a.style.width="14.28%",a.style.borderRadius="0.35rem",a.setAttribute("data-date",t.toISOString()),a.textContent=t.getDate(),t.getMonth()!==n&&a.classList.add("dtp-other-month","text-muted"),l&&m(t,l)&&a.classList.add("active"),c(t)&&a.classList.add("dtp-today"),a.addEventListener("click",e=>{e.stopPropagation(),p(t)}),s._days.appendChild(a)}l?(s._hour.value=l.getHours(),s._minute.value=l.getMinutes()):(s._hour.value=i.getHours(),s._minute.value=i.getMinutes())}function c(e){const t=new Date;return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}function m(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function p(e){const t=l?l.getHours():i.getHours(),n=l?l.getMinutes():i.getMinutes();l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),t,n,0,0),u()}function g(){const t=h(Number(s._hour.value),0,23),a=h(Number(s._minute.value),0,59);l||(l=new Date(i.getFullYear(),i.getMonth(),i.getDate(),t,a,0,0)),l.setHours(t,a,0,0),e.value=formatDate(l,o),n&&n(e.value),e.dispatchEvent(new Event("change",{bubbles:!0})),w()}function h(e,t,n){return isNaN(e)?t:Math.max(t,Math.min(n,e))}function y(){s||d();const t=parseInputToDate(e.value,o);l=t||l||new Date,i=new Date(l.getFullYear(),l.getMonth(),1,l.getHours(),l.getMinutes()),u(),function(){const t=e.getBoundingClientRect(),n=s.getBoundingClientRect(),a=window.scrollY||window.pageYOffset,o=window.scrollX||window.pageXOffset,r=window.innerHeight-t.bottom;let i=t.bottom+a+6;r<n.height+10&&(i=t.top+a-n.height-6);let l=t.left+o;l=Math.max(6,Math.min(l,document.documentElement.clientWidth-n.width-6)),s.style.position="absolute",s.style.top=`${i}px`,s.style.left=`${l}px`,s.style.zIndex=1080}(),s.style.display="block",s.classList.add("show"),s.querySelector(".dtp-hour").focus(),o.showTime||(console.log("hiding time"),s.querySelector(".dtp-time").setAttribute("style","display:none !important"))}function w(){s&&(s.style.display="none",s.classList.remove("show"))}function b(t){s&&"none"!==s.style.display&&(t.target===e||e.contains(t.target)||s.contains(t.target)||t.target===document.getElementById("dtpToggle")||w())}e.addEventListener("input",t=>{const a=parseInputToDate(e.value,o);a&&(l=a),n&&n(e.value)});const D={open:y,close:w,getDate:()=>l,setDate:t=>{t instanceof Date||(t=parseInputToDate(t,o)),l=t,e.value=l?formatDate(l,o):"",n&&n(e.value)},destroy:()=>{s&&(s.remove(),s=null),e.removeEventListener("focus",y),window.removeEventListener("click",b)}};return t&&t.addEventListener("click",e=>{e.stopPropagation(),s&&"block"===s.style.display?w():y()}),e.addEventListener("keydown",t=>{if(y(),e.focus(),""==e.value&&w(),"Escape"===t.key&&w(),"Enter"===t.key){const t=parseInputToDate(e.value,o);t&&(l=t,e.value=formatDate(t,o),e.dispatchEvent(new Event("change",{bubbles:!0})),n&&n(e.value)),w()}}),D}window.setDatetimeLocale=setDatetimeLocale,window.createDatetimeTemplate=createTemplate,window.createDatetimePicker=createDatetimePicker;