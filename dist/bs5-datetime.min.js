const DEFAULTS={format:"YYYY-MM-DD HH:mm",showTime:!0,showSeconds:!1,use24Hour:!0,startDay:1};function pad(e,t=2){return String(e).padStart(t,"0")}function formatDate(e,t){const n=e.getFullYear(),a=pad(e.getMonth()+1),o=pad(e.getDate()),s=pad(e.getHours()),l=pad(e.getMinutes());return"YYYY-MM-DD HH:mm"===t.format?`${n}-${a}-${o} ${s}:${l}`:"YYYY-MM-DD"===t.format?`${n}-${a}-${o}`:"MM/DD/YYYY HH:mm"===t.format?`${a}/${o}/${n} ${s}:${l}`:"MM/DD/YYYY"===t.format?`${a}/${o}/${n}`:`${n}-${a}-${o} ${s}:${l}`}function parseInputToDate(e){if(!e)return null;const t=e.match(/^(\d{4})-(\d{1,2})-(\d{1,2})(?:[T\s](\d{1,2}):(\d{1,2}))?/);if(!t)return null;const n=Number(t[1]),a=Number(t[2])-1,o=Number(t[3]),s=t[4]?Number(t[4]):0,l=t[5]?Number(t[5]):0,r=new Date(n,a,o,s,l,0,0);return isNaN(r)?null:r}function createTemplate(){if(document.getElementById("dtp-template"))return;const e=document.createElement("template");e.id="dtp-template",e.innerHTML=`\n      <div class="dtp-popup shadow rounded" role="dialog" aria-modal="false">\n          <div class="dtp-header d-flex justify-content-between align-items-center p-2 border-bottom">\n              <div class="dtp-month-year fs-6 fw-semibold"></div>\n              <div class="dtp-nav">\n              <button type="button" class="btn btn-sm dtp-prev" aria-label="${previousMonth}">‹</button>\n              <button type="button" class="btn btn-sm dtp-next" aria-label="${nextMonth}">›</button>\n              </div>\n          </div>\n\n          <div class="dtp-calendar p-2">\n              <div class="dtp-weekdays d-flex small text-muted"></div>\n              <div class="dtp-days d-flex flex-wrap"></div>\n          </div>\n\n          <div class="dtp-time p-2 border-top d-flex gap-2 align-items-center">\n              <label class="mb-0 small">${time}</label>\n              <input type="number" class="form-control form-control-sm dtp-hour" min="0" max="23" inputmode="numeric" aria-label="${hours}" style="width:4.5rem">\n              <span>:</span>\n              <input type="number" class="form-control form-control-sm dtp-minute" min="0" max="59" inputmode="numeric" aria-label="${minutes}" style="width:4.5rem">\n              <div class="ms-auto">\n              <button class="btn btn-sm btn-primary dtp-apply">${apply}</button>\n              </div>\n          </div>\n      </div>\n  `,document.body.appendChild(e)}function createDatetimePicker(e,t,n,a={}){const o=Object.assign({},DEFAULTS,a),s=document.getElementById("dtp-template");if(!s)throw new Error("Template not found");let l=null,r=null,d=null;function i(){l=s.content.firstElementChild.cloneNode(!0),document.body.appendChild(l),l.style.display="none",l._monthYear=l.querySelector(".dtp-month-year"),l._weekdays=l.querySelector(".dtp-weekdays"),l._days=l.querySelector(".dtp-days"),l._prev=l.querySelector(".dtp-prev"),l._next=l.querySelector(".dtp-next"),l._hour=l.querySelector(".dtp-hour"),l._minute=l.querySelector(".dtp-minute"),l._apply=l.querySelector(".dtp-apply"),o.showTime||(l.querySelector(".dtp-time").style.display="none"),l._prev.addEventListener("click",()=>{r.setMonth(r.getMonth()-1),u()}),l._next.addEventListener("click",()=>{r.setMonth(r.getMonth()+1),u()}),l._apply.addEventListener("click",g),l.addEventListener("keydown",t=>{"Escape"===t.key&&(v(),e.focus())}),setTimeout(()=>{window.addEventListener("click",f)},0),function(){const e=weekDays;l._weekdays.innerHTML="";for(let t=0;t<7;t++){const n=(o.startDay+t)%7,a=document.createElement("div");a.className="dtp-weekday flex-fill text-center",a.textContent=e[n],l._weekdays.appendChild(a)}}()}function u(){const e=r.getMonth(),t=monthNames[e],n=r.getFullYear();l._monthYear.textContent=`${t} ${n}`;let a=(new Date(n,e,1).getDay()-o.startDay+7)%7;const s=new Date(n,e,1-a);l._days.innerHTML="";for(let e=0;e<42;e++){const n=new Date(s.getFullYear(),s.getMonth(),s.getDate()+e),a=document.createElement("button");a.type="button",a.className="dtp-day btn btn-sm",a.style.width="14.28%",a.style.borderRadius="0.35rem",a.setAttribute("data-date",n.toISOString()),a.textContent=n.getDate(),n.getMonth()!==t&&a.classList.add("dtp-other-month","text-muted"),d&&p(n,d)&&a.classList.add("active"),c(n)&&a.classList.add("dtp-today"),a.addEventListener("click",e=>{e.stopPropagation(),m(n)}),l._days.appendChild(a)}d?(l._hour.value=d.getHours(),l._minute.value=d.getMinutes()):(l._hour.value=r.getHours(),l._minute.value=r.getMinutes())}function c(e){const t=new Date;return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}function p(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function m(e){const t=d?d.getHours():r.getHours(),n=d?d.getMinutes():r.getMinutes();d=new Date(e.getFullYear(),e.getMonth(),e.getDate(),t,n,0,0),u()}function g(){const t=y(Number(l._hour.value),0,23),a=y(Number(l._minute.value),0,59);d||(d=new Date(r.getFullYear(),r.getMonth(),r.getDate(),t,a,0,0)),d.setHours(t,a,0,0),e.value=formatDate(d,o),n&&n(e.value),e.dispatchEvent(new Event("change",{bubbles:!0})),v()}function y(e,t,n){return isNaN(e)?t:Math.max(t,Math.min(n,e))}function h(){l||i();const t=parseInputToDate(e.value);d=t||d||new Date,r=new Date(d.getFullYear(),d.getMonth(),1,d.getHours(),d.getMinutes()),u(),function(){const t=e.getBoundingClientRect(),n=l.getBoundingClientRect(),a=window.scrollY||window.pageYOffset,o=window.scrollX||window.pageXOffset,s=window.innerHeight-t.bottom;let r=t.bottom+a+6;s<n.height+10&&(r=t.top+a-n.height-6);let d=t.left+o;d=Math.max(6,Math.min(d,document.documentElement.clientWidth-n.width-6)),l.style.position="absolute",l.style.top=`${r}px`,l.style.left=`${d}px`,l.style.zIndex=1080}(),l.style.display="block",l.classList.add("show"),l.querySelector(".dtp-hour").focus()}function v(){l&&(l.style.display="none",l.classList.remove("show"))}function f(t){l&&"none"!==l.style.display&&(t.target===e||e.contains(t.target)||l.contains(t.target)||t.target===document.getElementById("dtpToggle")||v())}e.addEventListener("input",t=>{const a=parseInputToDate(e.value);a&&(d=a),n&&n(e.value)});const b={open:h,close:v,getDate:()=>d,setDate:t=>{t instanceof Date||(t=parseInputToDate(t)),d=t,e.value=d?formatDate(d,o):"",n&&n(e.value)},destroy:()=>{l&&(l.remove(),l=null),e.removeEventListener("focus",h),window.removeEventListener("click",f)}};return t&&t.addEventListener("click",e=>{e.stopPropagation(),l&&"block"===l.style.display?v():h()}),e.addEventListener("keydown",t=>{if(h(),e.focus(),""==e.value&&v(),"Escape"===t.key&&v(),"Enter"===t.key){const t=parseInputToDate(e.value);t&&(d=t,e.value=formatDate(t,o),e.dispatchEvent(new Event("change",{bubbles:!0})),n&&n(e.value)),v()}}),b}window.createDatetimeTemplate=createTemplate,window.createDatetimePicker=createDatetimePicker;